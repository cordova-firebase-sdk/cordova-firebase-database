sudo: false

env:
  global:
  - NODE_VERSION="9.11.2"
  - ANDROID_API="28"
  - ANDROID_BUILD_TOOLS="28.0.3"

notifications:
  email: false

branches:
  only:
  - master

matrix:
  include:
  - os: linux
    env: PLATFORM="only jest test"
    language: node_js
    node_js: '${NODE_VERSION}'
    before_script:
      - npm install /tmp/cordova-firebase-core/dist/
    script:
      - npm test

install:
  #- rm -rf ~/.nvm && git clone https://github.com/creationix/nvm.git ~/.nvm && (cd ~/.nvm
  #  && git checkout `git describe --abbrev=0 --tags`) && source ~/.nvm/nvm.sh && nvm
  #  install ${NODE_VERSION} > /dev/null
  - nvm install ${NODE_VERSION}
  - nvm use ${NODE_VERSION}
  - node --version
  - pushd /tmp &&
    git clone https://github.com/cordova-firebase-sdk/cordova-firebase-core &&
    cd cordova-firebase-core &&
    npm install &&
    npm run build &&
    popd
  - npm install && npm run build
